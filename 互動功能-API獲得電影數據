const API_KEY = "ä½ çš„APIé‡‘é‘°";  // é€™è£¡æ›æˆä½ ç”³è«‹çš„ TMDb API Key
const BASE_URL = "https://api.themoviedb.org/3";
const IMAGE_URL = "https://image.tmdb.org/t/p/w500";

// ğŸ”¹ 1. ç²å–ç†±é–€é›»å½±ï¼ˆé¦–é ï¼‰
async function fetchPopularMovies() {
    try {
        const response = await fetch(`${BASE_URL}/movie/popular?api_key=${API_KEY}&language=zh-TW&page=1`);
        const data = await response.json();
        displayMovies(data.results);
    } catch (error) {
        console.error("ç²å–é›»å½±è³‡æ–™å¤±æ•—:", error);
    }
}

// ğŸ”¹ 2. é¡¯ç¤ºé›»å½±åˆ—è¡¨
function displayMovies(movies) {
    const container = document.getElementById("movie-container");
    container.innerHTML = "";

    movies.forEach(movie => {
        const movieCard = document.createElement("div");
        movieCard.classList.add("movie-card");
        movieCard.innerHTML = `
            <img src="${IMAGE_URL + movie.poster_path}" alt="${movie.title}">
            <h3>${movie.title}</h3>
            <p>è©•åˆ†ï¼š${movie.vote_average}/10</p>
        `;
        movieCard.onclick = () => location.href = `movie.html?id=${movie.id}`;
        container.appendChild(movieCard);
    });
}

// ğŸ”¹ 3. ç²å–é›»å½±è©³ç´°è³‡è¨Šï¼ˆmovie.htmlï¼‰
async function loadMovieDetails() {
    const urlParams = new URLSearchParams(window.location.search);
    const movieId = urlParams.get("id");
    if (!movieId) return;

    try {
        const response = await fetch(`${BASE_URL}/movie/${movieId}?api_key=${API_KEY}&language=zh-TW`);
        const movie = await response.json();

        document.getElementById("movie-title").innerText = movie.title;
        document.getElementById("movie-year").innerText = movie.release_date;
        document.getElementById("movie-genre").innerText = movie.genres.map(g => g.name).join(", ");
        document.getElementById("movie-rating").innerText = movie.vote_average + "/10";
        document.getElementById("movie-description").innerText = movie.overview;
        document.getElementById("movie-poster").src = IMAGE_URL + movie.poster_path;
    } catch (error) {
        console.error("ç„¡æ³•ç²å–é›»å½±è©³æƒ…:", error);
    }
}

// ğŸ”¹ 4. ç•¶é¦–é è¼‰å…¥æ™‚ï¼Œé¡¯ç¤ºç†±é–€é›»å½±
if (document.getElementById("movie-container")) {
    document.addEventListener("DOMContentLoaded", fetchPopularMovies);
}

// ğŸ”¹ 5. ç•¶é›»å½±è©³æƒ…é è¼‰å…¥æ™‚ï¼Œé¡¯ç¤ºé›»å½±è³‡è¨Š
if (document.getElementById("movie-title")) {
    document.addEventListener("DOMContentLoaded", loadMovieDetails);
}
